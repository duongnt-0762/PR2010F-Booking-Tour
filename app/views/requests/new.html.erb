<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

<% provide(:title, 'Booking') %>
<div class='formbooking'>

    <%= form_for (@request) do |f| %>
      <div class="form-day">
        <div class="form-day1">
          <%= f.label :Checkin %>
          <%= f.date_field :day_start, class: "day_start", id: "day_start" %>
        </div>
        <div class="form-day2">
          <%= f.label :Checkout %>
          <%= f.date_field :day_end %>
        </div>
      </div>

          <%= f.hidden_field :price, value: @tour.price %>
          <%= f.hidden_field:tour_id, value: @tour.id %>

        <div class="ques-father">
          <div class="ques">
           <%= f.label :Guest %>
           <%= f.number_field :gues %><br>
          </div>
        </div>
        <div class="tongtien-father">
          <div class="tongtien">
           <%= f.label :Price %>
           <%= f.text_field :tour_price, value: @tour.price %><br>
          </div>
        </div>
        <div class="btn-father">
          <div class="btn">
            <%= f.submit "         Booking  now          ", class: "btn btn-danger", id: "special" %>
          </div>
        </div>
        <% end %>
</div>
<script>
  $(document).ready(function(){
    var date1 = $("#day_start").val();
    var date2 = $("#request_day_end").val();

    if (date1 != null ){
      $("#request_day_end").on("change",function(){
         $.ajax({
          url : '/tours/new',
          type : 'GET',
          dataType: 'json',
          data: {
            authenticity_token: $('[name="csrf-token"]')[0].content,
            day_start:$("#day_start").val(),
            day_end: $("#request_day_end").val(),
            tour_price: $('#request_price').val()
          },
          success: function(data){
            $("#request_tour_price").val(data);
          },
          error: function(data){
            alert("Ngày Checkout phải sau ngày Checkin");
          }
        });
      });
    }
    else if (date2 != null ){
      $("#day_start").on("change",function(){
        $.ajax({
          url : '/tours/new',
          type : 'GET',
          dataType: 'json',
          data: {
            authenticity_token: $('[name="csrf-token"]')[0].content,
            day_start:$("#day_start").val(),
            day_end: $("#request_day_end").val(),
            tour_price: $('#request_price').val()
          },
          success: function(data){
            $("#request_tour_price").val(data);
           },
           error: function(data){
            alert("Ngày Checkout phải sau ngày Checkin");
           }
        });
      });
    }
  });
</script>
